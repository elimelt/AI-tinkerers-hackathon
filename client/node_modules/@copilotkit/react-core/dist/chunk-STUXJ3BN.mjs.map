{"version":3,"sources":["../src/hooks/use-coagent-action.ts"],"sourcesContent":["import { useRef, useContext, useEffect } from \"react\";\nimport { CopilotContext } from \"../context/copilot-context\";\nimport { randomId } from \"@copilotkit/shared\";\nimport { CoagentAction } from \"../types/coagent-action\";\n\n// We implement useCoAgentAction dependency handling so that\n// the developer has the option to not provide any dependencies.\n// see useCopilotAction for more details about this approach.\nexport function useCoAgentAction<T = any>(action: CoagentAction<T>, dependencies?: any[]): void {\n  const { setCoagentAction, removeCoagentAction, coagentActions, chatComponentsCache } =\n    useContext(CopilotContext);\n  const idRef = useRef<string>(randomId());\n\n  const key = `${action.name}-${action.nodeName || \"global\"}`;\n\n  if (dependencies === undefined) {\n    if (coagentActions[idRef.current]) {\n      coagentActions[idRef.current].handler = action.handler as any;\n      if (typeof action.render === \"function\") {\n        if (chatComponentsCache.current !== null) {\n          chatComponentsCache.current.coagentActions[key] = action.render;\n        }\n      }\n    }\n  }\n\n  useEffect(() => {\n    setCoagentAction(idRef.current, action as any);\n    if (chatComponentsCache.current !== null && action.render !== undefined) {\n      chatComponentsCache.current.coagentActions[key] = action.render;\n    }\n    return () => {\n      removeCoagentAction(idRef.current);\n    };\n  }, [\n    setCoagentAction,\n    removeCoagentAction,\n    action.name,\n    // include render only if it's a string\n    typeof action.render === \"string\" ? action.render : undefined,\n    // dependencies set by the developer\n    ...(dependencies || []),\n  ]);\n}\n"],"mappings":";;;;;AAAA,SAAS,QAAQ,YAAY,iBAAiB;AAE9C,SAAS,gBAAgB;AAMlB,SAAS,iBAA0B,QAA0B,cAA4B;AAC9F,QAAM,EAAE,kBAAkB,qBAAqB,gBAAgB,oBAAoB,IACjF,WAAW,cAAc;AAC3B,QAAM,QAAQ,OAAe,SAAS,CAAC;AAEvC,QAAM,MAAM,GAAG,OAAO,QAAQ,OAAO,YAAY;AAEjD,MAAI,iBAAiB,QAAW;AAC9B,QAAI,eAAe,MAAM,OAAO,GAAG;AACjC,qBAAe,MAAM,OAAO,EAAE,UAAU,OAAO;AAC/C,UAAI,OAAO,OAAO,WAAW,YAAY;AACvC,YAAI,oBAAoB,YAAY,MAAM;AACxC,8BAAoB,QAAQ,eAAe,GAAG,IAAI,OAAO;AAAA,QAC3D;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAEA,YAAU,MAAM;AACd,qBAAiB,MAAM,SAAS,MAAa;AAC7C,QAAI,oBAAoB,YAAY,QAAQ,OAAO,WAAW,QAAW;AACvE,0BAAoB,QAAQ,eAAe,GAAG,IAAI,OAAO;AAAA,IAC3D;AACA,WAAO,MAAM;AACX,0BAAoB,MAAM,OAAO;AAAA,IACnC;AAAA,EACF,GAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA,OAAO;AAAA;AAAA,IAEP,OAAO,OAAO,WAAW,WAAW,OAAO,SAAS;AAAA;AAAA,IAEpD,GAAI,gBAAgB,CAAC;AAAA,EACvB,CAAC;AACH;","names":[]}